<app-top-bar></app-top-bar>

<div class="favorite-movies-page">

  <h2 class="title">Eleg√≠ tus pel√≠culas favoritas üé¨</h2>

  <p class="subtitle">
    Vamos a usar tus elecciones para detectar tus g√©neros preferidos
    y recomendarte pel√≠culas m√°s acertadas üòä
  </p>

  <!-- ============================== -->
  <!--       GRID DE PEL√çCULAS        -->
  <!-- ============================== -->

  <div class="movies-grid">
    @for (movie of movies; track movie.id) {

      <div class="movie-card"
           [class.selected]="isSelected(movie)"
           (click)="toggleMovie(movie)">

        <!-- Seleccionada -->
        @if (isSelected(movie)) {
          <div class="movie-card-badge">
            ‚úì Seleccionada
          </div>
        }

        <!-- Poster -->
        <img
          class="movie-poster"
          [src]="'https://image.tmdb.org/t/p/w500' + movie.poster_path"
          [alt]="movie.title"
        />

        <!-- Datos -->
        <div class="movie-card__info">
          <h3 class="movie-title">{{ movie.title }}</h3>
          <p class="movie-rating">‚≠ê {{ movie.vote_average }}</p>
        </div>

      </div>

    }
  </div>


  <!-- ============================== -->
  <!--        SELECCI√ìN Y ERRORES     -->
  <!-- ============================== -->

  <div class="selection-info">
    Pel√≠culas seleccionadas: <strong>{{ selectedMovieIds.size }}</strong>
  </div>

  @if (errorMsg) {
    <div class="alert error">{{ errorMsg }}</div>
  }


  <!-- ============================== -->
  <!--             BOTONES            -->
  <!-- ============================== -->

  <div class="buttons-row">

    <!-- Mezclar sin perder selecci√≥n -->
    <button class="btn-alt"
            type="button"
            (click)="loadRandomMovies(true)">
      Ver otras pel√≠culas
    </button>

    <!-- Guardar -->
    <button class="btn-primary"
            type="button"
            (click)="savePreferences()"
            [disabled]="selectedMovieIds.size === 0 || isSaving">
      {{ isSaving ? "Guardando..." : "Guardar preferencias" }}
    </button>

  </div>

</div>

<app-footer></app-footer>
