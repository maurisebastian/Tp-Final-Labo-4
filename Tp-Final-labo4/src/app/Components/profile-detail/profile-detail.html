<app-top-bar></app-top-bar>

@if (userLoggedIn) {

<div class="profile-page">

   <!-- COLUMNA IZQUIERDA -->
  <div class="left-column">

    <!-- Películas vistas y por ver -->
    <app-user-activity></app-user-activity>

    <!-- RESEÑAS -->
    <h3 class="section-title">Reseñas</h3>

    @if (reviews.length === 0) {
      <p class="empty-reviews">No tienes reseñas disponibles.</p>
    }

    @for (review of reviews; track $index) {
      <div class="review-card">

        <div class="review-header">
          <strong class="review-name">
            Película: {{ review.movieName || 'Cargando...' }}
          </strong>

          <span class="review-score">
            Calificación: {{ review.score }} / 10
          </span>

          <button class="delete-btn" (click)="deleteReview(review.id)">
            Eliminar
          </button>
        </div>

        <p class="review-text">
          {{ review.description }}
        </p>
      </div>
    }

    <!-- MIS REPORTES (solo los ve el usuario) -->
    <h3 class="section-title">Mis reportes</h3>

    @if (!myReports || myReports.length === 0) {
      <p class="empty-reviews">Todavía no realizaste ningún reporte.</p>
    } @else {
      <ul class="report-list">
        @for (report of myReports; track report.id) {
          <li class="report-item">
            <p><strong>Motivo:</strong> {{ report.reason }}</p>
            <p><strong>Fecha:</strong> {{ report.createdAt | date:'short' }}</p>
            <p><strong>Estado:</strong> {{ report.status }}</p>
          </li>
        }
      </ul>
    }

  </div> 

  <!-- COLUMNA DERECHA -->
  <div class="right-column">
    <!-- DETALLES DEL PERFIL -->
    <div class="profile-card">
      <h2 class="profile-title">Detalles del perfil</h2>

      <div class="profile-info">
        <p><strong>Usuario:</strong> {{ userProfile?.username }}</p>
        <p><strong>Email:</strong> {{ userProfile?.email }}</p>
        <p><strong>Fecha de nacimiento:</strong> {{ userProfile?.date }}</p>
        <p><strong>Celular:</strong> {{ userProfile?.cel }}</p>
      </div>
       <div class="visibility-box">
    <p><strong>Visibilidad del perfil:</strong></p>

    <button class="visibility-btn" (click)="toggleVisibility()">
      {{ userProfile?.isPublic ? 'Hacer perfil privado' : 'Hacer perfil público' }}
    </button>
  </div>


    </div>
        
  </div>

</div>
} @else {

  <p class="login-message">
    Por favor, inicie sesión para ver los detalles de su perfil.
  </p>

}

<app-footer></app-footer>
